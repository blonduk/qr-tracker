<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Glitch Link - Dashboard</title>
    <link rel="stylesheet" href="/static/style.css">
    <link rel="icon" type="image/png" href="/static/images/404_glitch.png">
</head>
<body>
    <header>
        <h1>Glitch Link</h1>
        <p class="subtitle">QR Code Generator and Tracker</p>
        <div class="nav-bar">
            <span class="user">Welcome, {{ user }}</span>
            <a href="/logout" class="btn small">Logout</a>
        </div>
    </header>

    <main>
        <section class="panel">
            <h2>Your QR Codes</h2>
            <form action="/add" method="POST" class="add-form">
                <input type="text" name="short_id" placeholder="Short Code" required>
                <input type="text" name="destination" placeholder="Destination URL" required>
                <button type="submit" class="btn">Add QR</button>
            </form>

            <table>
                <thead>
                    <tr>
                        <th>Short Code</th>
                        <th>Destination</th>
                        <th>Scans</th>
                        <th>QR</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for short_id, destination, count in stats %}
                    <tr>
                        <td>{{ short_id }}</td>
                        <td><a href="{{ destination }}" target="_blank">{{ destination }}</a></td>
                        <td>{{ count }}</td>
                        <td>
                            <a href="/view-qr/{{ short_id }}" target="_blank">
                                <img src="/view-qr/{{ short_id }}" alt="QR" width="60">
                            </a>
                        </td>
                        <td>
                            <form action="/edit" method="POST" class="inline-form">
                                <input type="hidden" name="short_id" value="{{ short_id }}">
                                <input type="text" name="new_destination" placeholder="New URL" required>
                                <button type="submit" class="btn small">Edit</button>
                            </form>
                            <form action="/delete/{{ short_id }}" method="POST" class="inline-form" onsubmit="return confirm('Delete this code?');">
                                <button type="submit" class="btn small red">Delete</button>
                            </form>
                            <div class="qr-downloads">
                                <a class="btn small ghost" href="/download-qr/{{ short_id }}.png">PNG</a>
                                <a class="btn small ghost" href="/download-qr/{{ short_id }}.svg">SVG</a>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>

            <div class="download-block">
                <a class="btn ghost" href="/export-csv">Export Logs (CSV)</a>
            </div>
        </section>
    </main>

    <footer>
        <p>&copy; {{ year }} Glitch Link. Built for chaos and clarity.</p>
    </footer>
</body>
</html>
